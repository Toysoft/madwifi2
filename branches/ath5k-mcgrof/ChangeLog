
2007-07-31	Luis R. Rodriguez <mcgrof@winlab.rutgers.edu>

	* regdomains: working on wireless-dev to implement new regulatory
	domain agent. Integrated into my implementation ar5k's channel reg map
	list. Last piece is to let mac80211 provide an array of
	ieee80211_channels on the cfg80211's current regdomain. Once thats
	done we can move on. Needs testing.

2007-07-27	Luis R. Rodriguez <mcgrof@winlab.rutgers.edu>

	Signed-off-by: Luis R. Rodriguez <mcgrof@winlab.rutgers.edu>

	* ath5k_hw.[ch]: removed ath5k_hw_get_regdomain(), remove
	AR5K_ELEMENTS and instead use ARRAY_SIZE.

2007-07-25	Luis R. Rodriguez <mcgrof@winlab.rutgers.edu>

	Signed-off-by: Luis R. Rodriguez <mcgrof@winlab.rutgers.edu>

	* ath5k_pci.c: remove ath_bmiss_tasklet()
	* if_ath.c: remove ath_chan2flags(), add ar_device(),
	ath_set_ack_bitrate(), start work on ath_reset() for mac80211. Clean
	ath_beaconq_config(), add ath_beacon_config(). Use
	ath5k_add_channels() and msecs_to_jiffies(). 

	* ath5k.c: rename ath_calc_bssid_mask() to ath5k_calc_bssid_mask(),
	ath_add_channels() to ath5k_add_channels(),
	ath_hal_mode_to_d80211_mode to ath5k_mode_to_mac80211_mode. Add
	ath5k_alloc(), ath5k_attach(), ath5k_detach(), ath5k_detach()

	* ath5k_hw.[ch], if_ath.c: Unused ath5k_hw_tx_desc_setup_xr(), sc_rc. Bring back
	if we add support for it. Needs proper integration with mac80211. Add
	ath5k_hw_get_cap_phycounters() macro, let if_ath.c use it instead old
	ath_hal_hwphycounters(), then move this check from ath_attach() to
	ath_init() and remove sc_needmib from ath_softc. Remove sc_keymax, as
	it seems this is static so far. Also remove
	ath5k_hw_get_keycache_size(). Make use of ath5k_hw_reset_key().

	* if_ath.c: remove sc_keymax

	* ath5k_hw.c: ath5k_hw_dump_state() is now a macro when ATH_DEBUG is
	not set. Finished reviewing ath5k_hw_init(). Probably good to go now.

	* ath5k.c: In ath5k_tx remove hardstart_fail goto label.
	Rename ath_calc_bssid_mask() to ath5k_calc_bssid_mask(). Rename
	ath_add_channels() to ath5k_add_channels(). Add ath5k_alloc(),
	ath5k_free(), ath5k_attach(), ath5k_detach() based on DadWifi

	* ath5k_hw.[ch]: moved tx/rx descriptor macros to ath5k_hw.h

	* ath5k_hw.h: un-typedef AR5K_RATE_TABLE.

	* ath5k_hw.[ch]: add PCI_ATH(), ATH5K_PRODUCT, cleanup PCI device listings. 
	Remove some PCI junk. Un-typedef AR5K_OPMODE, AR5K_SOFTC, AR5K_BUS_HANDLE,
	AR5K_BUS_ADDR, AR5K_BUS_HANDLE, AR5K_POWER_MODE. Delete unused elements 
	from struct ath_hal. Remove function pointers. Rename ath_hal_probe to
	ath5k_hw_mac_name. Clean ath5k_hw_init() declaration to only use
	needed variables and remove those variables from the routine. Rename
	ath5k_hw_set_power() to ath5k_hw_set_power_mode()
	Remove ath5k_hw_fill() and replace with macros as follows:

	Old driver			Function-pointer	New macro
	ath_hal_setuptxdesc()		ah_setup_tx_desc()	ath5k_hw_tx_desc_setup()
	ath_hal_setupxtxdesc()		ah_setup_xtx_desc()	ath5k_hw_tx_desc_setup_xr()
	ath_hal_filltxdesc()		ah_fill_tx_desc()	ath5k_hw_tx_desc_fill()
	ath_hal_txprocdesc()		ah_proc_tx_desc()	ath5k_hw_tx_desc_proc()
	ath_hal_rxprocdesc()		ah_proc_rx_desc()	ath5k_hw_rx_desc_proc()
	
	* ath5k_pci.c: use new PCI_ATH() and PCI_VDEVICE(). Set
	sc->sc_cachelsz here instead. Remove bus_read_cachesize. Remove
	ath_tx_tasklet_q0123() and ath_tx_tasklet(). We'll only use 2 hardware
	queues for now.

	* if_ath.c: use new macros. Remove cache line size setting on
	ath_attach().

